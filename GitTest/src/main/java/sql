--- DROP TABLE ---

DROP TABLE USERS;
DROP TABLE PROJECT;
DROP TABLE TASK;
DROP TABLE MEMBER;
DROP TABLE HISTORY;

--- CREATE TABLE --- 

CREATE TABLE USERS(
   USERNO NUMBER PRIMARY KEY,
   USERID VARCHAR2(30) NOT NULL,
   USERNAME VARCHAR2(30) NOT NULL,
   USERPWD VARCHAR2(50) NOT NULL,
   GROUPNAME VARCHAR2(100) NOT NULL,
   AUTHORITY VARCHAR2(50) NOT NULL
);

CREATE TABLE PROJECT(
   PROJECTNO NUMBER PRIMARY KEY,
   USERNO NUMBER NOT NULL CONSTRAINT USERNO_FK_P 
                          REFERENCES USERS(USERNO) ON DELETE CASCADE,
   PROJECTNAME VARCHAR2(200) NOT NULL,
   PROJECTCONTENT VARCHAR2(2000) NOT NULL,
   PROJECTSTATUS VARCHAR2(50) NOT NULL,
   STARTDATE DATE NOT NULL, 
   DUEDATE DATE NOT NULL
); 

CREATE TABLE TASK(
   PROJECTNO NUMBER NOT NULL CONSTRAINT PROJECTNO_FK_T 
                             REFERENCES PROJECT(PROJECTNO) ON DELETE CASCADE, 
   MEMBERNO NUMBER NOT NULL CONSTRAINT MEMBERNO_FK_T 
                          REFERENCES MEMBER(MEMBERNO) ON DELETE CASCADE,  
   TASKNO NUMBER PRIMARY KEY,
   TASKNAME VARCHAR2(200) NOT NULL,
   TASKCONTENT VARCHAR2(2000) NOT NULL,
   TASKPRIORITY VARCHAR2(50) NOT NULL,
   TASKSTATUS VARCHAR2(50) NOT NULL,
   STARTDATE DATE NOT NULL,
   DUEDATE DATE NOT NULL,
   TOTALTIME NUMBER NOT NULL,
   DONETIME NUMBER NOT NULL 
); 

CREATE TABLE MEMBER(
   MEMBERNO NUMBER PRIMARY KEY,
   PROJECTAUTHORITY VARCHAR2(50) NOT NULL,
   PROJECTNO NUMBER NOT NULL CONSTRAINT PROJECTNO_FK_M
                             REFERENCES PROJECT(PROJECTNO) ON DELETE CASCADE,
   USERNO NUMBER NOT NULL CONSTRAINT USERNO_FK_M
                          REFERENCES USERS(USERNO) ON DELETE CASCADE,
   CANWORK NUMBER NOT NULL,
   MUSTWORK NUMBER NOT NULL
);
    
CREATE TABLE HISTORY(
   PROJECTNO NUMBER NOT NULL CONSTRAINT PROJECTNO_FK_H
                             REFERENCES PROJECT(PROJECTNO) ON DELETE CASCADE,
   LOGTIME DATE NOT NULL,
   LOGCONTENT VARCHAR2(300) NOT NULL
); 

--- CREATE SEQUENCE --- 

CREATE SEQUENCE USER_SEQ;
CREATE SEQUENCE PROJECT_SEQ;
CREATE SEQUENCE TASK_SEQ;
CREATE SEQUENCE MEMBER_SEQ;

------ admin 계정 만들기 ------
insert into users
values(user_seq.nextval, 'admin', '관리자', 'admin', 'admin',' ');
--------------------------